(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9242],{43948:(e,s,t)=>{Promise.resolve().then(t.bind(t,12522)),Promise.resolve().then(t.bind(t,65831))},60839:(e,s,t)=>{"use strict";t.d(s,{UserAvatar:()=>i});var a=t(54568),l=t(93928),n=t(61773),r=t(7620);function i(e){let{image:s,fallbackValue:t,name:i,size:c="32px",className:o}=e,[d,u]=(0,r.useState)(!1),m=Number.parseInt(c.replace("px",""));return!s||d?(0,a.jsx)("div",{className:(0,l.cn)("overflow-hidden",o),children:(0,a.jsx)(n.default,{src:"/api/identicon/".concat(encodeURIComponent(t)),alt:i||"User identicon",width:m,height:m,className:"object-cover w-full h-full"})}):(0,a.jsx)("div",{className:(0,l.cn)("overflow-hidden",o),children:(0,a.jsx)(n.default,{src:s,alt:i||"User avatar",width:m,height:m,className:"object-cover w-full h-full",onError:()=>u(!0)})})}},65831:(e,s,t)=>{"use strict";t.d(s,{UsersClient:()=>F});var a=t(54568),l=t(64148),n=t(47227),r=t(92996),i=t(67876),c=t(65165),o=t(92555),d=t(24675),u=t(89609),m=t(60839),g=t(25316);let h=(0,g.createServerReference)("7f1f7e7e35f888d1f09452aa6528009955531d79ef",g.callServer,void 0,g.findSourceMapURL,"deleteMcpUsersAction");var x=t(2317),p=t(86002),f=t(42314),v=t(90031),j=t(5717),S=t(90517),w=t(33894),N=t(44747),C=t(79662),b=t(7657),k=t(68175),y=t(11794),A=t(27261),I=t.n(A),P=t(7620),R=t(51874);let z=[{id:"select",header:e=>{let{table:s}=e;return(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)(r.S,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:e=>s.toggleAllPageRowsSelected(!!e),"aria-label":"Select all"})})},cell:e=>{let{row:s}=e;return(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)(r.S,{checked:s.getIsSelected(),onCheckedChange:e=>s.toggleSelected(!!e),"aria-label":"Select row"})})},enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:"MCP User",cell:e=>{let{row:s}=e,t=s.original;return(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(m.UserAvatar,{image:t.image,fallbackValue:t.distinctId,name:t.name,size:"32px",className:"h-8 w-8 rounded-full"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)(I(),{href:"/dashboard/users/".concat(encodeURIComponent(t.distinctId)),className:"font-medium hover:underline",children:t.name}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:t.email}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["ID: ",t.distinctId]})]})]})},enableHiding:!1,filterFn:(e,s,t)=>{let a=e.original,l=t.toLowerCase();return a.name.toLowerCase().includes(l)||a.email.toLowerCase().includes(l)||a.distinctId.toLowerCase().includes(l)}},{accessorKey:"lifetimeSupportTickets",header:"Lifetime Support Tickets",cell:e=>{let{row:s}=e,t=s.getValue("lifetimeSupportTickets");return(0,a.jsx)(l.E,{variant:"outline",children:t})}},{accessorKey:"openSupportTickets",header:"Open Support Tickets",cell:e=>{let{row:s}=e,t=s.getValue("openSupportTickets");return(0,a.jsx)(l.E,{variant:"outline",children:t})}},{accessorKey:"connectedServers",header:"Connected Servers",cell:e=>{let{row:s}=e,t=s.getValue("connectedServers");return 0===t.length?(0,a.jsx)("span",{className:"text-muted-foreground",children:"No servers connected"}):(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:t.map(e=>(0,a.jsxs)(l.E,{variant:"secondary",className:"flex items-center gap-1",children:[(0,a.jsx)(y.A,{className:"h-3 w-3"}),e.serverSlug]},e.serverSlug))})},filterFn:(e,s,t)=>e.getValue(s).some(e=>e.serverName.toLowerCase().includes(t.toLowerCase())||e.serverSlug.toLowerCase().includes(t.toLowerCase()))},{accessorKey:"createdAt",header:"First Seen",cell:e=>{let{row:s}=e,t=s.getValue("createdAt");return(0,a.jsx)("span",{className:"text-muted-foreground text-sm",children:new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})}}];function M(e){var s,t,l;let{data:r}=e,[m,g]=P.useState({}),[y,A]=P.useState({}),[I,M]=P.useState([]),[F,U]=P.useState([]),[L,V]=P.useState({pageIndex:0,pageSize:10}),D=(0,b.N4)({data:r,columns:z,state:{sorting:F,columnVisibility:y,rowSelection:m,columnFilters:I,pagination:L},getRowId:e=>e.id,enableRowSelection:!0,onRowSelectionChange:g,onSortingChange:U,onColumnFiltersChange:M,onColumnVisibilityChange:A,onPaginationChange:V,getCoreRowModel:(0,k.HT)(),getFilteredRowModel:(0,k.hM)(),getPaginationRowModel:(0,k.kW)(),getSortedRowModel:(0,k.h5)()}),{execute:T,status:H}=(0,p.$)(h,{interceptors:[(0,x.L_)(e=>{R.oR.success("Successfully deleted ".concat(e.deletedCount," user(s)")),g({})}),(0,x.S5)(e=>{(0,x.Mj)(e)?R.oR.error("Failed to delete users: ".concat(e.message)):R.oR.error("Failed to delete users")})]}),E=D.getFilteredSelectedRowModel().rows.map(e=>e.original.id),K=async()=>{0!==E.length&&confirm("Are you sure you want to delete ".concat(E.length," user(s)? This action cannot be undone."))&&await T({userIds:E})};return(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(c.p,{placeholder:"Search users by name, email, or ID...",value:null!=(l=null==(s=D.getColumn("name"))?void 0:s.getFilterValue())?l:"",onChange:e=>{var s;return null==(s=D.getColumn("name"))?void 0:s.setFilterValue(e.target.value)},className:"max-w-sm"}),E.length>0&&(0,a.jsxs)(n.$,{variant:"destructive",size:"sm",onClick:K,disabled:"pending"===H,className:"flex items-center gap-2",children:[(0,a.jsx)(f.A,{className:"h-4 w-4"}),"pending"===H?"Deleting...":"Delete ".concat(E.length," user(s)")]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)(i.rI,{children:[(0,a.jsx)(i.ty,{asChild:!0,children:(0,a.jsxs)(n.$,{variant:"outline",size:"sm",children:[(0,a.jsx)(v.A,{}),(0,a.jsx)("span",{className:"hidden lg:inline",children:"Columns"}),(0,a.jsx)(j.A,{})]})}),(0,a.jsx)(i.SQ,{align:"end",className:"w-56",children:D.getAllColumns().filter(e=>void 0!==e.accessorFn&&e.getCanHide()).map(e=>(0,a.jsx)(i.hO,{className:"capitalize",checked:e.getIsVisible(),onCheckedChange:s=>e.toggleVisibility(!!s),children:e.id},e.id))})]})})]}),(0,a.jsx)("div",{className:"overflow-hidden rounded-lg border",children:(0,a.jsxs)(u.XI,{children:[(0,a.jsx)(u.A0,{className:"bg-muted",children:D.getHeaderGroups().map(e=>(0,a.jsx)(u.Hj,{children:e.headers.map(e=>(0,a.jsx)(u.nd,{colSpan:e.colSpan,children:e.isPlaceholder?null:(0,b.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,a.jsx)(u.BF,{children:(null==(t=D.getRowModel().rows)?void 0:t.length)?D.getRowModel().rows.map(e=>(0,a.jsx)(u.Hj,{"data-state":e.getIsSelected()&&"selected",children:e.getVisibleCells().map(e=>(0,a.jsx)(u.nA,{children:(0,b.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,a.jsx)(u.Hj,{children:(0,a.jsx)(u.nA,{colSpan:z.length,className:"h-24 text-center",children:"No users found."})})})]})}),(0,a.jsxs)("div",{className:"flex items-center justify-between px-4",children:[(0,a.jsxs)("div",{className:"text-muted-foreground hidden flex-1 text-sm lg:flex",children:[D.getFilteredSelectedRowModel().rows.length," of ",D.getFilteredRowModel().rows.length," ","row(s) selected."]}),(0,a.jsxs)("div",{className:"flex w-full items-center gap-8 lg:w-fit",children:[(0,a.jsxs)("div",{className:"hidden items-center gap-2 lg:flex",children:[(0,a.jsx)(o.J,{htmlFor:"rows-per-page",className:"text-sm font-medium",children:"Rows per page"}),(0,a.jsxs)(d.l6,{value:"".concat(D.getState().pagination.pageSize),onValueChange:e=>{D.setPageSize(Number(e))},children:[(0,a.jsx)(d.bq,{size:"sm",className:"w-20",id:"rows-per-page",children:(0,a.jsx)(d.yv,{placeholder:D.getState().pagination.pageSize})}),(0,a.jsx)(d.gC,{side:"top",children:[10,20,30,40,50].map(e=>(0,a.jsx)(d.eb,{value:"".concat(e),children:e},e))})]})]}),(0,a.jsxs)("div",{className:"flex w-fit items-center justify-center text-sm font-medium",children:["Page ",D.getState().pagination.pageIndex+1," of ",D.getPageCount()]}),(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-2 lg:ml-0",children:[(0,a.jsxs)(n.$,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>D.setPageIndex(0),disabled:!D.getCanPreviousPage(),children:[(0,a.jsx)("span",{className:"sr-only",children:"Go to first page"}),(0,a.jsx)(S.A,{})]}),(0,a.jsxs)(n.$,{variant:"outline",className:"size-8",size:"icon",onClick:()=>D.previousPage(),disabled:!D.getCanPreviousPage(),children:[(0,a.jsx)("span",{className:"sr-only",children:"Go to previous page"}),(0,a.jsx)(w.A,{})]}),(0,a.jsxs)(n.$,{variant:"outline",className:"size-8",size:"icon",onClick:()=>D.nextPage(),disabled:!D.getCanNextPage(),children:[(0,a.jsx)("span",{className:"sr-only",children:"Go to next page"}),(0,a.jsx)(N.A,{})]}),(0,a.jsxs)(n.$,{variant:"outline",className:"hidden size-8 lg:flex",size:"icon",onClick:()=>D.setPageIndex(D.getPageCount()-1),disabled:!D.getCanNextPage(),children:[(0,a.jsx)("span",{className:"sr-only",children:"Go to last page"}),(0,a.jsx)(C.A,{})]})]})]})]})]})}function F(e){let{mcpUsersPromise:s,supportTicketCountsPromise:t,openTicketCountsPromise:l}=e,n=(0,P.use)(s),r=(0,P.use)(t),i=(0,P.use)(l),c=new Map;for(let e of r)e.email&&c.set(e.email,{lifetime:e.lifetimeCount,open:0});for(let e of i)if(e.email){let s=c.get(e.email);s?s.open=e.openCount:c.set(e.email,{lifetime:e.openCount,open:e.openCount})}let o=new Map;for(let e of n){let s=e.distinctId;if(s){if(!o.has(s)){var d;let t=c.get(e.email||"")||{lifetime:0,open:0};o.set(s,{id:s,distinctId:s,name:e.oauthName||(null==(d=e.email)?void 0:d.split("@")[0])||"Unknown User",email:e.email,image:e.oauthImage,createdAt:new Date(e.firstSeenAt||Date.now()),lifetimeSupportTickets:t.lifetime,openSupportTickets:t.open,connectedServers:[]})}if(e.serverSlug){let t=o.get(s);t.connectedServers.find(s=>s.serverSlug===e.serverSlug)||t.connectedServers.push({distinctId:s,serverName:e.serverName||"Unknown Server",serverSlug:e.serverSlug,firstSeenAt:e.connectionCreatedAt,transport:e.transport})}}}let u=Array.from(o.values());return(0,a.jsx)(M,{data:u})}},92996:(e,s,t)=>{"use strict";t.d(s,{S:()=>i});var a=t(54568),l=t(23180),n=t(4931),r=t(93928);function i(e){let{className:s,...t}=e;return(0,a.jsx)(l.bL,{"data-slot":"checkbox",className:(0,r.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:(0,a.jsx)(l.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,a.jsx)(n.A,{className:"size-3.5"})})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[1637,1874,2102,7261,2317,4242,1292,3970,6631,3291,4917,9945,587,8315,7358],()=>s(43948)),_N_E=e.O()}]);