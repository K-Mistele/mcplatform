(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7993],{7886:(e,t,s)=>{"use strict";s.d(t,{AssignmentWidget:()=>m});var a=s(54568),n=s(23020),l=s(24675),r=s(25316);let i=(0,r.createServerReference)("7f741aad5d6d4b10bb78eaa1390c5b5cf1bddddfcc",r.callServer,void 0,r.findSourceMapURL,"assignSupportTicket");var d=s(2317),c=s(86002),o=s(7620),u=s(51874);function m(e){let{ticketId:t,currentAssigneeId:s,membersPromise:r,onAssignmentChanged:m}=e,x=(0,o.use)(r);x.find(e=>e.id===s);let{execute:p,status:h}=(0,c.$)(i,{interceptors:[(0,d.L_)(()=>{null==m||m(),u.oR.success("Assignment updated successfully")}),(0,d.S5)(e=>{console.error("Failed to update assignment:",e),u.oR.error("Failed to update assignment")})]}),g=async e=>{await p({ticketId:t,assigneeId:"unassigned"===e?null:e})};return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Assigned to"}),(0,a.jsxs)(l.l6,{value:s||"unassigned",onValueChange:g,disabled:"pending"===h,children:[(0,a.jsx)(l.bq,{className:"w-full h-auto!",size:"default",children:(0,a.jsx)(l.yv,{placeholder:"Assign to..."})}),(0,a.jsxs)(l.gC,{children:[(0,a.jsx)(l.eb,{value:"unassigned",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-6 w-6 rounded-full bg-muted flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-xs",children:"?"})}),(0,a.jsx)("span",{children:"Unassigned"})]})}),x.map(e=>{var t,s;return(0,a.jsx)(l.eb,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(n.eu,{className:"h-6 w-6",children:[(0,a.jsx)(n.BK,{src:e.image||"",alt:e.name||""}),(0,a.jsx)(n.q5,{className:"text-xs",children:(null==(s=e.name)||null==(t=s[0])?void 0:t.toUpperCase())||e.email[0].toUpperCase()})]}),(0,a.jsxs)("div",{className:"flex flex-col items-start justify-start",children:[(0,a.jsx)("div",{className:"font-medium",children:e.name||"Unknown"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:e.email})]})]})},e.id)})]})]})]})}},19738:(e,t,s)=>{"use strict";s.d(t,{StatusManager:()=>v});var a=s(54568),n=s(64148),l=s(47227),r=s(28359),i=s(24675),d=s(17129),c=s(25316);let o=(0,c.createServerReference)("7f3fd76179c9531b08d023cba874415757fbc4c992",c.callServer,void 0,c.findSourceMapURL,"updateSupportTicketStatus");var u=s(2317),m=s(86002),x=s(7620),p=s(51874),h=s(92555);let g=[{value:"needs_email",label:"Needs Email",description:"Waiting for user email"},{value:"pending",label:"Pending",description:"Waiting for review"},{value:"in_progress",label:"In Progress",description:"Currently being worked on"},{value:"resolved",label:"Resolved",description:"Issue has been fixed"},{value:"closed",label:"Closed",description:"Ticket is closed"}];function f(e){switch(e){case"needs_email":return"bg-amber-500 text-white border-amber-600 hover:bg-amber-600";case"pending":return"bg-blue-600 text-white border-blue-700 hover:bg-blue-700";case"in_progress":return"bg-purple-600 text-white border-purple-700 hover:bg-purple-700";case"resolved":return"bg-emerald-600 text-white border-emerald-700 hover:bg-emerald-700";default:return"bg-slate-600 text-white border-slate-700 hover:bg-slate-700"}}function v(e){var t;let{ticketId:s,currentStatus:c,onStatusChanged:v}=e,[j,b]=(0,x.useState)(c),[N,y]=(0,x.useState)(""),[w,S]=(0,x.useState)(!1),{execute:C,status:k}=(0,m.$)(o,{interceptors:[(0,u.L_)(()=>{y(""),b(c),null==v||v(),p.oR.success("Status updated successfully"),S(!1)}),(0,u.S5)(e=>{console.error("Failed to update status:",e),p.oR.error("Failed to update status")})]}),_=async()=>{await C({ticketId:s,status:j,comment:N.trim()||void 0})},E=(null==(t=g.find(e=>e.value===c))?void 0:t.label)||c;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.E,{className:f(c),children:E}),(0,a.jsxs)(r.lG,{open:w,onOpenChange:S,children:[(0,a.jsx)(r.zM,{asChild:!0,children:(0,a.jsx)(l.$,{variant:"outline",size:"sm",children:"Change Status"})}),(0,a.jsxs)(r.Cf,{children:[(0,a.jsxs)(r.c7,{children:[(0,a.jsx)(r.L3,{children:"Change Ticket Status"}),(0,a.jsx)(r.rr,{children:"Update the status of this support ticket. You can optionally add a comment to explain the change."})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(h.J,{className:"text-sm font-medium mb-2 block",children:"New Status"}),(0,a.jsxs)(i.l6,{value:j,onValueChange:b,children:[(0,a.jsx)(i.bq,{children:(0,a.jsx)(i.yv,{})}),(0,a.jsx)(i.gC,{children:g.map(e=>(0,a.jsx)(i.eb,{value:e.value,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.E,{className:f(e.value),children:e.label}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:["- ",e.description]})]})},e.value))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(h.J,{className:"text-sm font-medium mb-2 block",children:"Comment (optional)"}),(0,a.jsx)(d.T,{placeholder:"Add a comment explaining this status change...",value:N,onChange:e=>y(e.target.value),rows:3})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(l.$,{variant:"outline",onClick:()=>S(!1),disabled:"pending"===k,children:"Cancel"}),(0,a.jsx)(l.$,{onClick:_,disabled:j===c||"pending"===k,children:"pending"===k?"Updating...":"Update Status"})]})]})]})]})]})}},22866:(e,t,s)=>{"use strict";s.d(t,{EditableDescription:()=>v,EditableTitle:()=>f,PriorityDisplay:()=>b});var a=s(54568),n=s(64148),l=s(47227),r=s(65165),i=s(17129),d=s(25316);let c=(0,d.createServerReference)("7f5c5f5cee7c47e1c3e0b62680dafa28d64c757210",d.callServer,void 0,d.findSourceMapURL,"updateSupportTicketFields");var o=s(2317),u=s(86002),m=s(4931),x=s(12463),p=s(59388),h=s(7620),g=s(51874);function f(e){let{ticketId:t,initialValue:s,onUpdate:n}=e,[i,d]=(0,h.useState)(!1),[f,v]=(0,h.useState)(s||""),{execute:j,status:b}=(0,u.$)(c,{interceptors:[(0,o.L_)(()=>{d(!1),null==n||n(),g.oR.success("Title updated successfully")}),(0,o.S5)(e=>{console.error("Failed to update title:",e),g.oR.error("Failed to update title")})]}),N=async()=>{f.trim()!==s?await j({ticketId:t,title:f.trim()}):d(!1)},y=()=>{v(s||""),d(!1)};return i?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.p,{value:f,onChange:e=>v(e.target.value),className:"flex-1",placeholder:"Enter ticket title...",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key?N():"Escape"===e.key&&y()}}),(0,a.jsx)(l.$,{size:"sm",variant:"outline",onClick:N,disabled:"pending"===b,children:(0,a.jsx)(m.A,{className:"h-4 w-4"})}),(0,a.jsx)(l.$,{size:"sm",variant:"outline",onClick:y,disabled:"pending"===b,children:(0,a.jsx)(x.A,{className:"h-4 w-4"})})]}):(0,a.jsxs)("div",{className:"group flex items-center gap-2",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:f||"Support Ticket"}),(0,a.jsx)(l.$,{size:"sm",variant:"ghost",className:"opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>d(!0),children:(0,a.jsx)(p.A,{className:"h-4 w-4"})})]})}function v(e){let{ticketId:t,initialValue:s,onUpdate:n}=e,[r,d]=(0,h.useState)(!1),[m,x]=(0,h.useState)(s||""),{execute:f,status:v}=(0,u.$)(c,{interceptors:[(0,o.L_)(()=>{d(!1),null==n||n(),g.oR.success("Description updated successfully")}),(0,o.S5)(e=>{console.error("Failed to update description:",e),g.oR.error("Failed to update description")})]}),j=async()=>{m.trim()!==s?await f({ticketId:t,conciseSummary:m.trim()}):d(!1)};return r?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(i.T,{value:m,onChange:e=>x(e.target.value),placeholder:"Enter problem description...",rows:6,className:"w-full"}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(l.$,{size:"sm",variant:"outline",onClick:()=>{x(s||""),d(!1)},disabled:"pending"===v,children:"Cancel"}),(0,a.jsx)(l.$,{size:"sm",onClick:j,disabled:"pending"===v,children:"Save"})]})]}):(0,a.jsxs)("div",{className:"group space-y-2",children:[(0,a.jsx)("div",{className:"prose prose-sm max-w-none",children:(0,a.jsx)("p",{className:"text-sm leading-relaxed",children:m||"No summary provided"})}),(0,a.jsxs)(l.$,{size:"sm",variant:"ghost",className:"opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>d(!0),children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-1"}),"Edit"]})]})}let j=[{value:"low",label:"Low",color:"bg-green-100 text-green-800 border-green-300"},{value:"medium",label:"Medium",color:"bg-blue-100 text-blue-800 border-blue-300"},{value:"high",label:"High",color:"bg-orange-100 text-orange-800 border-orange-300"},{value:"critical",label:"Critical",color:"bg-red-100 text-red-800 border-red-300"}];function b(e){let{currentPriority:t}=e,s=j.find(e=>e.value===t)||j[1];return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Priority"}),(0,a.jsx)(n.E,{className:s.color,children:s.label})]})}},23020:(e,t,s)=>{"use strict";s.d(t,{BK:()=>i,eu:()=>r,q5:()=>d});var a=s(54568),n=s(46256),l=s(93928);function r(e){let{className:t,...s}=e;return(0,a.jsx)(n.bL,{"data-slot":"avatar",className:(0,l.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...s})}function i(e){let{className:t,...s}=e;return(0,a.jsx)(n._V,{"data-slot":"avatar-image",className:(0,l.cn)("aspect-square size-full",t),...s})}function d(e){let{className:t,...s}=e;return(0,a.jsx)(n.H4,{"data-slot":"avatar-fallback",className:(0,l.cn)("bg-muted flex size-full items-center justify-center rounded-full",t),...s})}},24675:(e,t,s)=>{"use strict";s.d(t,{bq:()=>m,eb:()=>p,gC:()=>x,l6:()=>c,s3:()=>o,yv:()=>u});var a=s(54568),n=s(93709),l=s(74711),r=s(4931),i=s(76430),d=s(93928);function c(e){let{...t}=e;return(0,a.jsx)(n.bL,{"data-slot":"select",...t})}function o(e){let{...t}=e;return(0,a.jsx)(n.YJ,{"data-slot":"select-group",...t})}function u(e){let{...t}=e;return(0,a.jsx)(n.WT,{"data-slot":"select-value",...t})}function m(e){let{className:t,size:s="default",children:r,...i}=e;return(0,a.jsxs)(n.l9,{"data-slot":"select-trigger","data-size":s,className:(0,d.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...i,children:[r,(0,a.jsx)(n.In,{asChild:!0,children:(0,a.jsx)(l.A,{className:"size-4 opacity-50"})})]})}function x(e){let{className:t,children:s,position:l="popper",...r}=e;return(0,a.jsx)(n.ZL,{children:(0,a.jsxs)(n.UC,{"data-slot":"select-content",className:(0,d.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l,...r,children:[(0,a.jsx)(h,{}),(0,a.jsx)(n.LM,{className:(0,d.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,a.jsx)(g,{})]})})}function p(e){let{className:t,children:s,...l}=e;return(0,a.jsxs)(n.q7,{"data-slot":"select-item",className:(0,d.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...l,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(n.VF,{children:(0,a.jsx)(r.A,{className:"size-4"})})}),(0,a.jsx)(n.p4,{children:s})]})}function h(e){let{className:t,...s}=e;return(0,a.jsx)(n.PP,{"data-slot":"select-scroll-up-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(i.A,{className:"size-4"})})}function g(e){let{className:t,...s}=e;return(0,a.jsx)(n.wn,{"data-slot":"select-scroll-down-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(l.A,{className:"size-4"})})}},28359:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>m,Es:()=>p,HM:()=>o,L3:()=>h,c7:()=>x,lG:()=>i,rr:()=>g,zM:()=>d});var a=s(54568),n=s(25173),l=s(12463),r=s(93928);function i(e){let{...t}=e;return(0,a.jsx)(n.bL,{"data-slot":"dialog",...t})}function d(e){let{...t}=e;return(0,a.jsx)(n.l9,{"data-slot":"dialog-trigger",...t})}function c(e){let{...t}=e;return(0,a.jsx)(n.ZL,{"data-slot":"dialog-portal",...t})}function o(e){let{...t}=e;return(0,a.jsx)(n.bm,{"data-slot":"dialog-close",...t})}function u(e){let{className:t,...s}=e;return(0,a.jsx)(n.hJ,{"data-slot":"dialog-overlay",className:(0,r.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function m(e){let{className:t,children:s,showCloseButton:i=!0,...d}=e;return(0,a.jsxs)(c,{"data-slot":"dialog-portal",children:[(0,a.jsx)(u,{}),(0,a.jsxs)(n.UC,{"data-slot":"dialog-content",className:(0,r.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...d,children:[s,i&&(0,a.jsxs)(n.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(l.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function x(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,r.cn)("flex flex-col gap-2 text-center sm:text-left",t),...s})}function p(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,r.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function h(e){let{className:t,...s}=e;return(0,a.jsx)(n.hE,{"data-slot":"dialog-title",className:(0,r.cn)("text-lg leading-none font-semibold",t),...s})}function g(e){let{className:t,...s}=e;return(0,a.jsx)(n.VY,{"data-slot":"dialog-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...s})}},57071:(e,t,s)=>{"use strict";s.d(t,{ActivityStream:()=>el});var a=s(54568),n=s(23020),l=s(64148),r=s(63353),i=s(90264),d=s(32471),c=s(24508),o=s(93167),u=s(59388),m=s(85321),x=s(84453),p=s(7620),h=s(47227),g=s(67876),f=s(25316);let v=(0,f.createServerReference)("7f9dc6ba00de1ba620c9bc82f10c37996707bca439",f.callServer,void 0,f.findSourceMapURL,"deleteSupportTicketComment");var j=s(2317),b=s(86002),N=s(71690),y=s(73385),w=s(51874),S=s(28359);let C=(0,f.createServerReference)("7f54d88fdd88141a7ff5d47fc011d71f1f3402aab3",f.callServer,void 0,f.findSourceMapURL,"editSupportTicketComment");var k=s(93928),_=s(22466),E=s(84910),z=s(21506),A=s(94382),R=s(94406),L=s(77662),T=s(3101),$=s(85164),M=s(78261),U=s(72993),F=s(12670),I=s(65512),D=s(82603),P=s(44845),q=s(14277),J=s(26795),K=s(62147);let W={namespace:"SupportTicketEditor",theme:{paragraph:"text-sm leading-6",heading:{h1:"text-2xl font-bold mb-3",h2:"text-xl font-bold mb-2",h3:"text-lg font-semibold mb-2"},list:{listitem:"ml-4",ol:"list-decimal ml-4",ul:"list-disc ml-4"},text:{bold:"font-semibold",italic:"italic",code:"bg-muted px-1 py-0.5 rounded text-sm font-mono"},code:"bg-muted p-3 rounded-md block font-mono text-sm",quote:"border-l-4 border-muted-foreground/30 pl-4 my-2 text-muted-foreground"},nodes:[J.jL,K.fD3,K.Ey8,J.dJ,z.v5,z.YW,E.Db,R.Vd,_.iK,_.yy,U.fS,E.k_],onError:e=>{console.error("Lexical error:",e)}};function Y(e){let{placeholder:t="Start typing...",onChange:s,value:n,initialValue:l="",readOnly:r=!1,className:i="",minHeight:d=120}=e,[c,o]=(0,p.useState)(null);return(0,a.jsx)("div",{className:(0,k.cn)("relative overflow-hidden rounded-md border border-input bg-background text-sm ring-offset-background focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2",i),children:(0,a.jsx)(T.n,{initialConfig:{...W,editable:!r,editorState:n||l?()=>(0,A.Wn)(n||l,[A._s,...A.Gi,...A.Yz,...A.JI,...A.r5]):void 0},children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(q.$,{contentEditable:(0,a.jsx)("div",{ref:e=>{null!==e&&o(e)},children:(0,a.jsx)($.a,{className:(0,k.cn)("px-3 py-2 text-sm focus:outline-none resize-none",r&&"cursor-default"),style:{minHeight:"".concat(d,"px")}})}),ErrorBoundary:M.R,placeholder:(0,a.jsx)("div",{className:"pointer-events-none absolute top-2 left-3 text-sm text-muted-foreground",children:t})}),!r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.D,{onChange:e=>{s&&e.read(()=>{s((0,A.bk)([A._s,...A.Gi,...A.Yz,...A.JI,...A.r5]))})}}),(0,a.jsx)(F.C,{}),(0,a.jsx)(L.A,{}),(0,a.jsx)(I.Q,{}),(0,a.jsx)(D.E,{transformers:[A._s,...A.Gi,...A.Yz,...A.JI,...A.r5]})]})]})})})}function O(e){let{open:t,onOpenChange:s,activityId:n,initialContent:l}=e,[r,i]=(0,p.useState)(l),{execute:d,status:c}=(0,b.$)(C,{interceptors:[(0,j.L_)(()=>{w.oR.success("Comment updated successfully"),s(!1)}),(0,j.S5)(e=>{(0,j.Mj)(e)?w.oR.error(e.message):w.oR.error("Failed to update comment")})]}),o=async()=>{if(!r.trim())return void w.oR.error("Comment cannot be empty");await d({activityId:n,content:r.trim(),contentType:"text"})};return(0,p.useState)(()=>{t&&i(l)}),(0,a.jsx)(S.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(S.Cf,{className:"sm:max-w-[600px]",children:[(0,a.jsxs)(S.c7,{children:[(0,a.jsx)(S.L3,{children:"Edit Comment"}),(0,a.jsx)(S.rr,{children:"Make changes to your comment. You can use markdown formatting."})]}),(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)(Y,{value:r,onChange:i,placeholder:"Enter your comment...",minHeight:150})}),(0,a.jsxs)(S.Es,{children:[(0,a.jsx)(h.$,{variant:"outline",onClick:()=>{i(l),s(!1)},disabled:"pending"===c,children:"Cancel"}),(0,a.jsx)(h.$,{onClick:o,disabled:"pending"===c||!r.trim(),children:"pending"===c?"Saving...":"Save Changes"})]})]})})}function V(e){let{activityId:t,content:s}=e,[n,l]=(0,p.useState)(!1),{execute:r,status:i}=(0,b.$)(v,{interceptors:[(0,j.L_)(()=>{w.oR.success("Comment deleted successfully")}),(0,j.S5)(e=>{(0,j.Mj)(e)?w.oR.error(e.message):w.oR.error("Failed to delete comment")})]}),d=async()=>{confirm("Are you sure you want to delete this comment? This action cannot be undone.")&&await r({activityId:t})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(g.rI,{children:[(0,a.jsx)(g.ty,{asChild:!0,children:(0,a.jsxs)(h.$,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:[(0,a.jsx)(N.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Open comment menu"})]})}),(0,a.jsxs)(g.SQ,{align:"end",className:"w-32",children:[(0,a.jsxs)(g._2,{onClick:()=>l(!0),children:[(0,a.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,a.jsxs)(g._2,{onClick:d,disabled:"pending"===i,className:"text-destructive focus:text-destructive",children:[(0,a.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"pending"===i?"Deleting...":"Delete"]})]})]}),(0,a.jsx)(O,{open:n,onOpenChange:l,activityId:t,initialContent:s})]})}var G=s(24675);let H=(0,f.createServerReference)("7fe5d6b915e8ba8ab4121022f91e3abab234520486",f.callServer,void 0,f.findSourceMapURL,"addSupportTicketCommentWithStatus");var B=s(92555);let Z=[{value:"needs_email",label:"Needs Email",description:"Waiting for user email"},{value:"pending",label:"Pending",description:"Waiting for review"},{value:"in_progress",label:"In Progress",description:"Currently being worked on"},{value:"resolved",label:"Resolved",description:"Issue has been fixed"},{value:"closed",label:"Closed",description:"Ticket is closed"}];function Q(e){switch(e){case"needs_email":return"bg-amber-500 text-white border-amber-600 hover:bg-amber-600";case"pending":return"bg-blue-600 text-white border-blue-700 hover:bg-blue-700";case"in_progress":return"bg-purple-600 text-white border-purple-700 hover:bg-purple-700";case"resolved":return"bg-emerald-600 text-white border-emerald-700 hover:bg-emerald-700";default:return"bg-slate-600 text-white border-slate-700 hover:bg-slate-700"}}function X(e){var t,s;let{ticketId:n,currentStatus:r,onCommentAdded:i}=e,[d,c]=(0,p.useState)(""),[o,u]=(0,p.useState)(void 0),{execute:m,status:x}=(0,b.$)(H,{interceptors:[(0,j.L_)(()=>{c(""),u(void 0),null==i||i()}),(0,j.S5)(e=>{console.error("Failed to add comment:",e)})]}),g=async()=>{d.trim()&&await m({ticketId:n,content:d.trim(),contentType:"text",status:o})},f=o&&o!==r;return(0,a.jsxs)("div",{className:"space-y-4 border rounded-lg p-4",children:[(0,a.jsx)("div",{onKeyDown:e=>{"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),g())},children:(0,a.jsx)(Y,{placeholder:"Add a comment... (Cmd/Ctrl + Enter to submit)",value:d,onChange:c,minHeight:100})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(B.J,{className:"text-sm font-medium mb-2 block",children:"Change Status (optional)"}),(0,a.jsxs)(G.l6,{value:o||"keep_current",onValueChange:e=>u("keep_current"===e?void 0:e),children:[(0,a.jsx)(G.bq,{className:"w-full",children:(0,a.jsx)(G.yv,{placeholder:"Keep current status"})}),(0,a.jsxs)(G.gC,{children:[(0,a.jsx)(G.eb,{value:"keep_current",children:(0,a.jsx)("span",{className:"text-muted-foreground",children:"Keep current status"})}),Z.map(e=>(0,a.jsx)(G.eb,{value:e.value,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(l.E,{className:Q(e.value),children:e.label}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:["- ",e.description]})]})},e.value))]})]})]}),f&&(0,a.jsx)("div",{className:"p-3 border-blue-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("span",{children:"Status will change from"}),(0,a.jsx)(l.E,{className:Q(r),children:(null==(t=Z.find(e=>e.value===r))?void 0:t.label)||r}),(0,a.jsx)("span",{children:"to"}),(0,a.jsx)(l.E,{className:Q(o),children:(null==(s=Z.find(e=>e.value===o))?void 0:s.label)||o})]})}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(h.$,{type:"button",variant:"outline",onClick:()=>{c(""),u(void 0)},disabled:"pending"===x||!d.trim()&&!o,children:"Cancel"}),(0,a.jsx)(h.$,{type:"button",onClick:g,disabled:"pending"===x||!d.trim(),children:"pending"===x?"Adding...":f?"Add Comment & Change Status":"Add Comment"})]})]})]})}var ee=s(36083);function et(e){switch(e){case"comment":return(0,a.jsx)(d.A,{className:"h-4 w-4"});case"status_change":return(0,a.jsx)(c.A,{className:"h-4 w-4"});case"assignment":return(0,a.jsx)(o.A,{className:"h-4 w-4"});case"field_update":return(0,a.jsx)(u.A,{className:"h-4 w-4"});case"system":return(0,a.jsx)(m.A,{className:"h-4 w-4"});default:return(0,a.jsx)(x.A,{className:"h-4 w-4"})}}function es(e){switch(e){case"needs_email":return"bg-amber-500 text-white border-amber-600 hover:bg-amber-600";case"pending":return"bg-blue-600 text-white border-blue-700 hover:bg-blue-700";case"in_progress":return"bg-purple-600 text-white border-purple-700 hover:bg-purple-700";case"resolved":return"bg-emerald-600 text-white border-emerald-700 hover:bg-emerald-700";default:return"bg-slate-600 text-white border-slate-700 hover:bg-slate-700"}}function ea(e){var t,s;let{activity:r}=e,i=r.userName?r.userName.split(" ").map(e=>e[0]).join("").toUpperCase():(null==(s=r.userEmail)||null==(t=s[0])?void 0:t.toUpperCase())||"U";return(0,a.jsx)("div",{className:"border rounded-lg p-4 bg-card",children:(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)(n.eu,{className:"h-8 w-8 flex-shrink-0",children:[(0,a.jsx)(n.BK,{src:"",alt:r.userName||r.userEmail||""}),(0,a.jsx)(n.q5,{className:"text-xs",children:i})]}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(()=>{var e,t,s,n,i,d,c,o,u,m,x,p;switch(r.activityType){case"comment":{let c=!!((null==(t=r.metadata)||null==(e=t.statusChange)?void 0:e.oldStatus)&&(null==(n=r.metadata)||null==(s=n.statusChange)?void 0:s.newStatus));return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium flex-wrap",children:[(0,a.jsx)("span",{children:r.userName||r.userEmail}),(0,a.jsx)("span",{className:"text-muted-foreground",children:c?"commented and changed status":"commented"}),et("comment")]}),(0,a.jsx)(V,{activityId:r.id,content:r.content})]}),c&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm ml-6 flex-wrap",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Status changed from"}),(0,a.jsx)(l.E,{className:es(r.metadata.statusChange.oldStatus),children:null==(i=r.metadata.statusChange.oldStatus)?void 0:i.replace("_"," ")}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"to"}),(0,a.jsx)(l.E,{className:es(r.metadata.statusChange.newStatus),children:null==(d=r.metadata.statusChange.newStatus)?void 0:d.replace("_"," ")})]}),(0,a.jsx)("div",{className:"ml-6",children:(0,a.jsx)(ee.T,{content:r.content})})]})}case"status_change":if(!(null==(c=r.content)?void 0:c.oldStatus)||!(null==(o=r.content)?void 0:o.newStatus))return(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,a.jsx)("span",{children:r.userName||r.userEmail}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"changed status"}),et("status_change")]});return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium flex-wrap",children:[(0,a.jsx)("span",{children:r.userName||r.userEmail}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"changed status from"}),(0,a.jsx)(l.E,{className:es(r.content.oldStatus),children:null==(u=r.content.oldStatus)?void 0:u.replace("_"," ")}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"to"}),(0,a.jsx)(l.E,{className:es(r.content.newStatus),children:null==(m=r.content.newStatus)?void 0:m.replace("_"," ")}),et("status_change")]}),(null==(x=r.metadata)?void 0:x.comment)&&(0,a.jsxs)("div",{className:"ml-6 text-sm text-muted-foreground",children:['"',r.metadata.comment,'"']})]});case"assignment":return(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,a.jsx)("span",{children:r.userName||r.userEmail}),(null==(p=r.content)?void 0:p.newAssigneeId)?(0,a.jsx)("span",{className:"text-muted-foreground",children:"assigned this ticket"}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"unassigned this ticket"}),et("assignment")]});case"field_update":{if(!r.content||"object"!=typeof r.content)return(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,a.jsx)("span",{children:r.userName||r.userEmail}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"updated fields"}),et("field_update")]});let e=Object.keys(r.content);return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,a.jsx)("span",{children:r.userName||r.userEmail}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"updated"}),et("field_update")]}),(0,a.jsx)("div",{className:"ml-6 space-y-1",children:e.map(e=>{var t,s;return(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("span",{className:"font-medium",children:[e,":"]}),(0,a.jsxs)("span",{className:"text-muted-foreground ml-1",children:['"',(null==(t=r.content[e])?void 0:t.old)||"N/A",'" â†’ "',(null==(s=r.content[e])?void 0:s.new)||"N/A",'"']})]},e)})})]})}default:return(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"System activity"}),et("system")]})}})(),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:(0,a.jsx)(en,{timestamp:r.createdAt})})]})]})})}function en(e){let{timestamp:t}=e,s=function(e){let[t,s]=(0,p.useState)(null);return(0,p.useEffect)(()=>{let t=()=>{let t=new Date(e),a=Math.floor((new Date().getTime()-t.getTime())/1e3);if(a<60)s("Just now");else if(a<3600){let e=Math.floor(a/60);s("".concat(e," minute").concat(e>1?"s":""," ago"))}else if(a<86400){let e=Math.floor(a/3600);s("".concat(e," hour").concat(e>1?"s":""," ago"))}else s(null)};t();let a=setInterval(t,6e4);return()=>clearInterval(a)},[e]),t}(t),n=new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return(0,a.jsx)("span",{title:n,children:s||n})}function el(e){let{activitiesPromise:t,ticketId:s,currentStatus:n}=e,l=(0,p.use)(t);return(0,a.jsxs)(r.Zp,{className:"mt-6",children:[(0,a.jsx)(r.aR,{children:(0,a.jsxs)(r.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(d.A,{className:"h-5 w-5"}),"Activity"]})}),(0,a.jsxs)(r.Wu,{className:"space-y-0",children:[(0,a.jsx)(X,{ticketId:s,currentStatus:n}),(0,a.jsx)(i.w,{className:"my-6"}),(0,a.jsx)("div",{className:"space-y-4",children:0===l.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No activity yet"}):l.map(e=>(0,a.jsx)(ea,{activity:e},e.id))})]})]})}},78215:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,27261,23)),Promise.resolve().then(s.bind(s,12522)),Promise.resolve().then(s.bind(s,57071)),Promise.resolve().then(s.bind(s,7886)),Promise.resolve().then(s.bind(s,22866)),Promise.resolve().then(s.bind(s,19738))}},e=>{var t=t=>e(e.s=t);e.O(0,[1637,1874,2102,7261,2317,4242,1292,667,6631,9749,9941,7472,587,8315,7358],()=>t(78215)),_N_E=e.O()}]);