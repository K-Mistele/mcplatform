(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2681],{12681:(e,t,r)=>{r.r(t),r.d(t,{RIGHT_CLICK_IMAGE_COMMAND:()=>C,default:()=>k});var n=r(54568),s=r(7620),i=r(97407),o=r(41867),a=r(89220),l=r(78261),c=r(98136),u=r(14138),d=r(14277),g=r(95224),m=r(70198),h=r(15062),p=r(62147),f=r(43045),b=r(47227);function w(e,t,r){return Math.min(Math.max(e,t),r)}const v={east:1,north:8,south:2,west:4};function x(e){const{onResizeStart:t,onResizeEnd:r,buttonRef:i,imageRef:o,maxWidth:a,editor:l,showCaption:c,setShowCaption:u,captionsEnabled:d}=e,g=(0,s.useRef)(null),m=(0,s.useRef)({priority:"",value:"default"}),p=(0,s.useRef)({currentHeight:0,currentWidth:0,direction:0,isResizing:!1,ratio:0,startHeight:0,startWidth:0,startX:0,startY:0}),f=l.getRootElement(),x=a||(null!==f?f.getBoundingClientRect().width-20:100),y=null!==f?f.getBoundingClientRect().height-20:100,E=e=>{const t=e===v.east||e===v.west,r=e===v.north||e===v.south,n=e&v.north&&e&v.west||e&v.south&&e&v.east,s=t?"ew":r?"ns":n?"nwse":"nesw";null!==f&&f.style.setProperty("cursor","".concat(s,"-resize"),"important"),null!==document.body&&(document.body.style.setProperty("cursor","".concat(s,"-resize"),"important"),m.current.value=document.body.style.getPropertyValue("-webkit-user-select"),m.current.priority=document.body.style.getPropertyPriority("-webkit-user-select"),document.body.style.setProperty("-webkit-user-select","none","important"))},C=()=>{null!==f&&f.style.setProperty("cursor","text"),null!==document.body&&(document.body.style.setProperty("cursor","default"),document.body.style.setProperty("-webkit-user-select",m.current.value,m.current.priority))},R=(e,r)=>{if(!l.isEditable())return;const n=o.current,s=g.current;if(null!==n&&null!==s){e.preventDefault();const{width:i,height:o}=n.getBoundingClientRect(),a=(0,h.OV)(n),l=p.current;l.startWidth=i,l.startHeight=o,l.ratio=i/o,l.currentWidth=i,l.currentHeight=o,l.startX=e.clientX/a,l.startY=e.clientY/a,l.isResizing=!0,l.direction=r,E(r),t(),s.classList.add("touch-action-none"),n.style.height="".concat(o,"px"),n.style.width="".concat(i,"px"),document.addEventListener("pointermove",z),document.addEventListener("pointerup",k)}},z=e=>{const t=o.current,r=p.current,n=r.direction&(v.east|v.west),s=r.direction&(v.south|v.north);if(null!==t&&r.isResizing){const i=(0,h.OV)(t);if(n&&s){let n=Math.floor(r.startX-e.clientX/i);n=r.direction&v.east?-n:n;const s=w(r.startWidth+n,100,x),o=s/r.ratio;t.style.width="".concat(s,"px"),t.style.height="".concat(o,"px"),r.currentHeight=o,r.currentWidth=s}else if(s){let n=Math.floor(r.startY-e.clientY/i);n=r.direction&v.south?-n:n;const s=w(r.startHeight+n,100,y);t.style.height="".concat(s,"px"),r.currentHeight=s}else{let n=Math.floor(r.startX-e.clientX/i);n=r.direction&v.east?-n:n;const s=w(r.startWidth+n,100,x);t.style.width="".concat(s,"px"),r.currentWidth=s}}},k=()=>{const e=o.current,t=p.current,n=g.current;if(null!==e&&null!==n&&t.isResizing){const e=t.currentWidth,s=t.currentHeight;t.startWidth=0,t.startHeight=0,t.ratio=0,t.startX=0,t.startY=0,t.currentWidth=0,t.currentHeight=0,t.isResizing=!1,n.classList.remove("touch-action-none"),C(),r(e,s),document.removeEventListener("pointermove",z),document.removeEventListener("pointerup",k)}};return(0,n.jsxs)("div",{ref:g,children:[!c&&d&&(0,n.jsx)(b.$,{className:"image-caption-button absolute bottom-1 left-1/2 -translate-x-1/2",ref:i,variant:"outline",onClick:()=>{u(!c)},children:"Add Caption"}),(0,n.jsx)("div",{className:"image-resizer image-resizer-n bg-primary absolute -top-2.5 left-1/2 h-3 w-3 -translate-x-1/2 cursor-ns-resize",onPointerDown:e=>{R(e,v.north)}}),(0,n.jsx)("div",{className:"image-resizer image-resizer-ne bg-primary absolute -top-2.5 -right-2.5 h-3 w-3 cursor-nesw-resize",onPointerDown:e=>{R(e,v.north|v.east)}}),(0,n.jsx)("div",{className:"image-resizer image-resizer-e bg-primary absolute top-1/2 -right-2.5 h-3 w-3 -translate-y-1/2 cursor-ew-resize",onPointerDown:e=>{R(e,v.east)}}),(0,n.jsx)("div",{className:"image-resizer image-resizer-se bg-primary absolute -right-2.5 -bottom-2.5 h-3 w-3 cursor-nwse-resize",onPointerDown:e=>{R(e,v.south|v.east)}}),(0,n.jsx)("div",{className:"image-resizer image-resizer-s bg-primary absolute -bottom-2.5 left-1/2 h-3 w-3 -translate-x-1/2 cursor-ns-resize",onPointerDown:e=>{R(e,v.south)}}),(0,n.jsx)("div",{className:"image-resizer image-resizer-sw bg-primary absolute -bottom-2.5 -left-2.5 h-3 w-3 cursor-nesw-resize",onPointerDown:e=>{R(e,v.south|v.west)}}),(0,n.jsx)("div",{className:"image-resizer image-resizer-w bg-primary absolute top-1/2 -left-2.5 h-3 w-3 -translate-y-1/2 cursor-ew-resize",onPointerDown:e=>{R(e,v.west)}}),(0,n.jsx)("div",{className:"image-resizer image-resizer-nw bg-primary absolute -top-2.5 -left-2.5 h-3 w-3 cursor-nwse-resize",onPointerDown:e=>{R(e,v.north|v.west)}})]})}var y=r(25334);const E=new Set,C=(0,p.guI)("RIGHT_CLICK_IMAGE_COMMAND");function R(e){const{altText:t,className:r,imageRef:s,src:i,width:o,height:a,maxWidth:l,onError:c}=e;if(!E.has(i))throw new Promise(e=>{const t=new Image;t.src=i,t.onload=()=>{E.add(i),e(null)},t.onerror=()=>{E.add(i)}});return(0,n.jsx)("img",{className:r||void 0,src:i,alt:t,ref:s,style:{height:a,maxWidth:l,width:o},onError:c,draggable:"false"})}function z(){return(0,n.jsx)("img",{src:"",style:{height:200,opacity:.2,width:200},draggable:"false"})}function k(e){const{src:t,altText:r,nodeKey:b,width:w,height:v,maxWidth:E,resizable:k,showCaption:j,caption:N,captionsEnabled:_}=e,M=(0,s.useRef)(null),D=(0,s.useRef)(null),[P,L,S]=(0,m.Y)(b),[W,A]=(0,s.useState)(!1),{isCollabActive:T}=(0,o.k)(),[H]=(0,a.DF)(),[I,J]=(0,s.useState)(null),G=(0,s.useRef)(null),[O,X]=(0,s.useState)(!1),K=(0,g.a)(),Z=(0,s.useCallback)(e=>{const t=(0,p.vJq)();return P&&(0,p.RTZ)(t)&&(e.preventDefault(),H.update(()=>{t.getNodes().forEach(e=>{(0,y.Eh)(e)&&e.remove()})})),!1},[H,P]),Y=(0,s.useCallback)(e=>{const t=(0,p.vJq)(),r=D.current;if(P&&(0,p.RTZ)(t)&&1===t.getNodes().length){if(j)return(0,p.n1P)(null),e.preventDefault(),N.focus(),!0;else if(null!==r&&r!==document.activeElement)return e.preventDefault(),r.focus(),!0}return!1},[N,P,j]),q=(0,s.useCallback)(e=>(G.current===N||D.current===e.target)&&((0,p.n1P)(null),H.update(()=>{L(!0);const e=H.getRootElement();null!==e&&e.focus()}),!0),[N,H,L]),$=(0,s.useCallback)(e=>!!W||e.target===M.current&&(e.shiftKey?L(!P):(S(),L(!0)),!0),[W,P,L,S]),B=(0,s.useCallback)(e=>{H.getEditorState().read(()=>{const t=(0,p.vJq)();"IMG"===e.target.tagName&&(0,p.I2P)(t)&&1===t.getNodes().length&&H.dispatchCommand(C,e)})},[H]);(0,s.useEffect)(()=>{let e=!0,t=H.getRootElement(),r=(0,h.Sd)(H.registerUpdateListener(t=>{const{editorState:r}=t;e&&J(r.read(()=>(0,p.vJq)()))}),H.registerCommand(p.MvL,(e,t)=>(G.current=t,!1),p.AcJ),H.registerCommand(p.d8p,$,p.AcJ),H.registerCommand(C,$,p.AcJ),H.registerCommand(p.TgX,e=>e.target===M.current&&(e.preventDefault(),!0),p.AcJ),H.registerCommand(p.w$Z,Z,p.AcJ),H.registerCommand(p.gCZ,Z,p.AcJ),H.registerCommand(p.RTo,Y,p.AcJ),H.registerCommand(p.Q$N,q,p.AcJ));return null==t||t.addEventListener("contextmenu",B),()=>{e=!1,r(),null==t||t.removeEventListener("contextmenu",B)}},[S,H,W,P,b,Z,Y,q,$,B,L]);const F=P&&(0,p.RTZ)(I)&&!W,U=(P||W)&&K;return(0,n.jsx)(s.Suspense,{fallback:null,children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{draggable:F,children:O?(0,n.jsx)(z,{}):(0,n.jsx)(R,{className:"max-w-full cursor-default ".concat(U?"".concat((0,p.RTZ)(I)?"draggable cursor-grab active:cursor-grabbing":""," focused ring-primary ring-2 ring-offset-2"):null),src:t,altText:r,imageRef:M,width:w,height:v,maxWidth:E,onError:()=>X(!0)})}),j&&(0,n.jsx)("div",{className:"image-caption-container absolute right-0 bottom-1 left-0 m-0 block min-w-[100px] overflow-hidden border-t bg-white/90 p-0",children:(0,n.jsxs)(u.s,{initialEditor:N,initialNodes:[p.haT,p.Ey8,p.fD3],children:[(0,n.jsx)(i.x,{}),(0,n.jsx)(c.G,{}),(0,n.jsx)(d.$,{contentEditable:(0,n.jsx)(f.a,{className:"ImageNode__contentEditable user-select-text word-break-break-word caret-primary relative block min-h-5 w-[calc(100%-20px)] cursor-text resize-none border-0 p-2.5 text-sm whitespace-pre-wrap outline-none",placeholderClassName:"ImageNode__placeholder text-sm text-muted-foreground overflow-hidden absolute top-2.5 left-2.5 pointer-events-none text-ellipsis user-select-none whitespace-nowrap inline-block",placeholder:"Enter a caption..."}),ErrorBoundary:l.R})]})}),k&&(0,p.RTZ)(I)&&U&&(0,n.jsx)(x,{showCaption:j,setShowCaption:()=>{H.update(()=>{const e=(0,p.nsf)(b);(0,y.Eh)(e)&&e.setShowCaption(!0)})},editor:H,buttonRef:D,imageRef:M,maxWidth:E,onResizeStart:()=>{A(!0)},onResizeEnd:(e,t)=>{setTimeout(()=>{A(!1)},200),H.update(()=>{const r=(0,p.nsf)(b);(0,y.Eh)(r)&&r.setWidthAndHeight(e,t)})},captionsEnabled:!O&&_})]})})}},14138:(e,t,r)=>{r.d(t,{s:()=>d});var n=r(41867),s=r(89220),i=r(62147),o=r(7620),a=r(54568);function l(e){const t=e.transform();return new Set(t?[t]:[])}const c=()=>{},u=()=>{};function d({initialEditor:e,children:t,initialNodes:r,initialTheme:d,skipCollabChecks:g,skipEditableListener:m}){const h=(0,o.useRef)(!1),p=(0,o.useContext)(s.Gu);null==p&&((e,...t)=> {const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;for(const e of(n.append("code",9),t))n.append("v",e);throw r.search=n.toString(),Error(`Minified Lexical error #${9}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(9);const[f,{getTheme:b}]=p,w=(0,o.useMemo)(()=>{const t=d||b()||void 0,n=(0,s.Mx)(p,t);void 0!==t&&(e._config.theme=t),e._parentEditor=e._parentEditor||f;const o=e._createEditorArgs,a=o&&o.namespace;if(r)for(let t of(c(),a||(u(),e._config.namespace=f._config.namespace),r)){let r=null,n=null;if("function"!=typeof t){const e=t;t=e.replace,r=e.with,n=e.withKlass||null}const s=(0,i.Jvg)(e,t.getType());e._nodes.set(t.getType(),{exportDOM:s?s.exportDOM:void 0,klass:t,replace:r,replaceWithKlass:n,sharedNodeState:(0,i.j17)(t),transforms:l(t)})}else if(o&&o.nodes)a||(u(),e._config.namespace=f._config.namespace);else{const t=e._nodes=new Map(f._nodes);for(const[r,n]of(a||(e._config.namespace=f._config.namespace),t))e._nodes.set(r,{exportDOM:n.exportDOM,klass:n.klass,replace:n.replace,replaceWithKlass:n.replaceWithKlass,sharedNodeState:(0,i.j17)(n.klass),transforms:l(n.klass)})}return[e,n]},[]),{isCollabActive:v,yjsDocMap:x}=(0,n.k)(),y=g||h.current||x.has(e.getKey());return(0,o.useEffect)(()=>{y&&(h.current=!0)},[y]),(0,o.useEffect)(()=>{if(!m){const t=t=>e.setEditable(t);return t(f.isEditable()),f.registerEditableListener(t)}},[e,f,m]),(0,a.jsx)(s.Gu.Provider,{value:w,children:!v||y?t:null})}},41867:(e,t,r)=>{r.d(t,{k:()=>a});var n=r(7620);const s=[["Cat","rgb(125, 50, 0)"],["Dog","rgb(100, 0, 0)"],["Rabbit","rgb(150, 0, 0)"],["Frog","rgb(200, 0, 0)"],["Fox","rgb(200, 75, 0)"],["Hedgehog","rgb(0, 75, 0)"],["Pigeon","rgb(0, 125, 0)"],["Squirrel","rgb(75, 100, 0)"],["Bear","rgb(125, 100, 0)"],["Tiger","rgb(0, 0, 150)"],["Leopard","rgb(0, 0, 200)"],["Zebra","rgb(0, 0, 250)"],["Wolf","rgb(0, 100, 150)"],["Owl","rgb(0, 100, 100)"],["Gull","rgb(100, 0, 100)"],["Squid","rgb(150, 0, 150)"]],i=s[Math.floor(Math.random()*s.length)],o=(0,n.createContext)({clientID:0,color:i[1],isCollabActive:!1,name:i[0],yjsDocMap:new Map});function a(e,t){const r=(0,n.useContext)(o);return null!=e&&(r.name=e),null!=t&&(r.color=t),r}}}]);